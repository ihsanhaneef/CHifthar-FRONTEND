<!-- admintable.html -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Table</title>
    
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
      }
  
      /* Header styles */
      header {
        background-color: #333;
        color: #fff;
        padding: 10px 20px;
      }
  
      nav ul {
        list-style-type: none;
        padding: 0;
        color: black;
      }
  
      nav ul li {
        display: inline;
        margin-right: 20px;
        color: black;
      }
  
      nav ul li a {
        color: #fff;
        text-decoration: none;
        color: black;
      }
  
      /* Main content styles */
      main {
        padding: 20px;
      }
  
      section {
        margin-bottom: 40px;
      }
  
      h2 {
        margin-bottom: 10px;
        background-color: black;
        font-size: x-large;
        color: white;
        padding: 20px;
      }
  
      table {
        width: 100%;
        border-collapse: collapse;
      }
  
      th, td {
        padding: 8px;
        border: 1px solid #ddd;
        
      }
  
      th {
        background-color: #ccd3eb;
      }
      tr{
        text-align: center;
      }
      button {
  background-color: #4CAF50; /* Green */
  border: none;
  color: white;
  padding: 10px 20px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 16px;
  margin: 4px 2px;
  cursor: pointer;
  border-radius: 4px;
  /* margin: auto;
    display: block; */
  
}

button:hover {
  background-color: #74b978;
}

button:active {
  background-color: red;
}
input {
  background-color: #26ceb2; /* Green */
  border: none;
  color: white;
  padding: 10px 20px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 16px;
  margin: 4px 2px;
  cursor: pointer;
  border-radius: 4px;
}
#topButton {
  display: block; /* Hide the button by default */
  position: fixed; /* Fixed position to keep it in the viewport */
  bottom: 30px; /* Adjust the distance from the bottom */
  right: 30px; /* Adjust the distance from the right */
  z-index: 99; /* Ensure it appears above other elements */
  background-color: #008CBA; /* Button background color */
  color: white; /* Button text color */
  border: none; /* Remove border */
  border-radius: 10%; /* Make it a circle */
  padding: 15px; /* Adjust padding */
  font-size: 16px; /* Adjust font size */
  cursor: pointer; /* Change cursor to pointer */
  box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.3); /* Add a shadow effect */
  transition: background-color 0.3s ease; /* Add smooth transition */
}

#topButton:hover {
  background-color: #005f79; /* Button color on hover */
}



    </style>
  </head>
  <body>
  <!-- ======= Header ======= -->
  <head id="header">
    

        <nav id="navbar" class="navbar" style="margin: 20px;">
            <ul>
                <li><button id="logout" style="background-color: red;">Logout</button></li>
                <li><a class="nav-link scrollto active" href="index.html">Home</a></li>
                <li><a class="nav-link scrollto active" href="#download">download</a></li>
                <li><a class="nav-link scrollto" href="#Announcement">Announcement</a></li>
                <!-- <li><a class="nav-link scrollto" href="#debate">debate</a></li> -->
              
            </ul>
           
        </nav>
  
  </head>
  <main>
  <section id="download" style="background-color: #ffffff; margin: -20px;align-items: center; justify-content: center;">
                  <!-- all download button -->
                  <h1 style="text-align: center; font-size: xx-large; font-family: Georgia, 'Times New Roman', Times, serif;"><b>ifthar admin  Admin Panel</b></h1>
  <div><h2 style="padding: 20px; color: rgb(255, 255, 255); text-align: center;">REGISTRATION DATA</h2></div>
    
    <button id="downloadDebate">download ifthar data</button>
 
  </section>




<section id="Announcement" style="background-color: #ffffff; margin:-20px; align-items: center; justify-content: center; padding-top: 50px;" >
    
  <div style="background-color: #000000;"><h2 style="padding: 20px; color: rgb(255, 255, 255); text-align: center;">ADD ANNOUNCEMENT</h2></div>
    <form id="announcement" style="align-items: center; justify-content: center">
      <label style="padding: 50px; font-size: x-large;">Announcement</label>
      <input name="announcement" style="width: 400px;">
      <button>Add</button>
      
    
    </form>
    
  </section>

  
  <!-- ------------------------------------- -->

  <section id="Notification" style="background-color: #ffffff; margin:-20px; align-items: center; justify-content: center; padding-top: 50px;" >
    
    <div style="background-color: #000000;"><h2 style="padding: 20px; color: rgb(255, 255, 255); text-align: center;">ADD Notification</h2></div>
      <form id="notification" style="align-items: center; justify-content: center">
        <label style="padding: 50px; font-size: x-large;">Notification</label>
        <input name="notification" style="width: 400px;">
        <button>Add</button>
        
      
      </form>
      
    </section>

    <!-- debate -->
    <section id="debate" style="padding-top: 50px;">
    <h2 id="heading">IFTHAR 24</h2>
    <table border="1" align="center" style="width: 100%" id="debateTable">
      <thead>
        <tr>
          <th>Email</th>
          <th>GENDER</th>
          <th>REG ID</th>
          <th>NAME</th>
          <th>payment status</th>
        </tr>
      </thead>
      <tbody>
        <!-- console.log(data) -->
        <!-- Data will be inserted here dynamically -->
      </tbody>
    </table>
  </section>


 




  </main>
    <script>

  

   
//debate===========================================
      const downloadDebate = document.getElementById("downloadDebate");
      downloadDebate.addEventListener("click", () => {
        console.log("a");
        fetch("https://chifthar24fd.onrender.com/api/download/debate", {
        // fetch("http://localhost:7003/api/download/debate", {
          method: "GET",
          headers: {
            Authorization: localStorage.getItem("token"),
          },
        }).then((response) => {
          response.blob().then((blob) => {
            // Create a temporary anchor element
            const link = document.createElement("a");
            link.href = window.URL.createObjectURL(blob);

            // Set the file name for the download
            link.download = "ifthar data.csv";

            // Programmatically click the anchor element to trigger the download
            link.click();

            // Clean up - remove the anchor element and revoke the object URL
            link.remove();
          });
        });
      });



   



      // <!-- -------------------------------------------------------------------------- -->
      const announcementForm = document.getElementById("announcement");
      announcementForm.addEventListener("submit", (e) => {
        e.preventDefault();
        const formData = new FormData(e.currentTarget);
        fetch("https://chifthar24fd.onrender.com/api/anno", {
          method: "POST",
          body: JSON.stringify({ value: formData.get("announcement") }),
          headers: {
            "Content-Type": "application/json",
            Authorization: localStorage.getItem("token"),
          },
        });
      });
// -----------------------------------------------------------------------------------------


      // <!-- -------------------------------------------------------------------------- -->
//notification 


      const notificationForm = document.getElementById("notification");
      notificationForm.addEventListener("submit", (e) => {
        e.preventDefault();
        const formData = new FormData(e.currentTarget);
        fetch("https://chifthar24fd.onrender.com/api/noti", {
          method: "POST",
          body: JSON.stringify({ value: formData.get("notification") }),
          headers: {
            "Content-Type": "application/json",
            Authorization: localStorage.getItem("token"),
          },
        });
      });











// scoreboard

      // Fetch data from the server
      function fetchAndCreateTable() {
        fetch("https://chifthar24fd.onrender.com/api/admin2/register", {
          method: "GET",
          headers: {
            "Content-Type": "application/json",
            Authorization: localStorage.getItem("token"),
          },
        }).then((response) => {
          if (response?.status == 404) {
            window.location.href = "./login.html";
          }
          response.json().then((data) => {


        


//Start of debate logic
            const debateTable = document.getElementById("debateTable");
            const debateBody = debateTable.querySelector("tbody");
            debateBody.innerHTML = "";
            console.log(data)
            // server  V
            data?.debateData.forEach((entry) => {
              // const participant = entry.participants[0];

              const row = document.createElement("tr");

              const emailCell = document.createElement("td");
              emailCell.textContent = entry.email;
              row.appendChild(emailCell);

              const genderCell = document.createElement("td");
              genderCell.textContent = entry?.gender;
              row.appendChild(genderCell);

              const usernameCell = document.createElement("td");
              usernameCell.textContent = entry?.username;
              row.appendChild(usernameCell);

              const regidCell = document.createElement("td");
              regidCell.textContent = entry.regid;
              row.appendChild(regidCell);

              const payStatus = document.createElement("td");
              const hi = document.createElement("p");
              hi.innerText = entry?.paymentStatus ? "✔️" : "❌";
              payStatus.appendChild(hi);

              const paidToggleButton = document.createElement("button");
              paidToggleButton.innerText = "Toggle";

              paidToggleButton.addEventListener("click", () => {
                togglePaymentStatus(
                  entry?._id,
                  !entry?.paymentStatus,
                  "debate"
                );
              });

              payStatus.appendChild(paidToggleButton);

              // payStatus.textContent = entry.paymentStatus;
              row.appendChild(payStatus);

              debateBody.appendChild(row);
            });
          });
        });
      }

    
      fetchAndCreateTable();

      function togglePaymentStatus(id, status, eventName) {
        fetch("https://chifthar24fd.onrender.com/api/admin2/togglepayment", {
          method: "POST",
          body: JSON.stringify({ id, status, eventName }),
          headers: {
            "Content-Type": "application/json",
            Authorization: localStorage.getItem("token"),
          },
        }).then((res) => {
          console.log("Toggle sucess");
          fetchAndCreateTable();
        });
      }

      const LogoutButton = document.getElementById("logout");
      LogoutButton.addEventListener("click", () => {
        localStorage.removeItem("token");
        window.location.href = "/login.html";
      });
    </script>

    <!-- ===================================================================================================================== -->
    <!-- ////top button -->
    <button onclick="topFunction()" id="topButton" title="Go to top">Top</button>
<script>// When the user scrolls down 20px from the top of the document, show the button
  window.onscroll = function() {scrollFunction()};
  
  function scrollFunction() {
    if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
      document.getElementById("topButton").style.display = "block";
    } else {
      document.getElementById("topButton").style.display = "none";
    }
  }
  
  // When the user clicks on the button, scroll to the top of the document
  function topFunction() {
    document.body.scrollTop = 0; // For Safari
    document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
  }
  </script>



<!-- live event script--------------------------------------------------------------------------------------- -->



  </body>
</html>
